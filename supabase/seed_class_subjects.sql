-- ================================================
-- CLASS-SUBJECT ASSIGNMENTS WITH TEACHER ALLOCATIONS
-- Academic Year: 2025-2026
-- Mashaail Muscat Private School
--
-- TEACHER HEADCOUNT PLAN (max ~24 periods/week per teacher):
--
-- ISL (4-5 ppw): 20 classes → need 4 teachers
--   TCH-001: KG1A, KG1B, KG2A, KG2B        → 4+4+4+4 = 16 ppw ✓
--   TCH-014: G1A, G1B, G2A, G2B             → 5+5+5+5 = 20 ppw ✓
--   TCH-029: G3A, G3B, G4A, G4B             → 5+5+5+5 = 20 ppw ✓
--   TCH-033: G5A, G5B, G6A, G6B, G7A, G7B, G8A, G8B → 5×8=40 ← split needed
--   Split ISL G5-G8 across TCH-029+TCH-033:
--   TCH-029: G3A, G3B, G4A, G4B, G5A, G5B  → 5×6 = 30 (too heavy)
--   Better: 4 ISL teachers, each covering 5 classes max:
--   TCH-001: KG1A, KG1B, KG2A, KG2B, G1A, G1B → 4+4+4+4+5+5 = 26 ← borderline
--   Split into neat pairs:
--
-- FINAL TEACHER PLAN (grade pairs, 2 sections each = 4 classes per pair):
--
-- KG HOMEROOM RULE:
--   KG-1 A homeroom = TCH-001 (Fatma)  → ISL+ARA+MAT+SCI+LFS = 21ppw ✓
--   KG-1 B homeroom = TCH-014 (Salma)  → ISL+ARA+MAT+SCI+LFS = 21ppw ✓
--   KG-2 A homeroom = TCH-002 (Maryam) → ISL+ARA+MAT+SCI+LFS = 21ppw ✓
--   KG-2 B homeroom = TCH-015 (Nawal)  → ISL+ARA+MAT+SCI+LFS = 21ppw ✓
--   Specialists for KG: ENG=TCH-003, ART=TCH-010, PE=TCH-013
--
-- ISL (G1-G8 only, KG handled by homeroom):
--   TCH-014: G1A+G1B+G2A+G2B (4×5=20 ppw) — note TCH-014 also teaches KG1B homeroom; total=21+20=41 ← too much
--   Fix: Use dedicated ISL teachers for G1-G8 only (TCH-029, TCH-033, TCH-034)
--   TCH-029: G1A+G1B+G2A+G2B (4×5=20 ppw)
--   TCH-033(NEW): G3A+G3B+G4A+G4B+G5A+G5B+G6A+G6B → split to G3-G4 only
--   TCH-029: G1A+G1B+G2A+G2B+G3A+G3B+G4A+G4B (8×5=40 ← too heavy) → split:
--   TCH-029: G1A+G1B+G2A+G2B (4×5=20 ppw) ✓
--   TCH-033(NEW): G3A+G3B+G4A+G4B+G5A+G5B+G6A+G6B (8×5=40 ← too heavy) → split:
--   TCH-033(NEW): G3A+G3B+G4A+G4B (4×5=20 ppw) ✓
--   TCH-034(NEW): G5A+G5B+G6A+G6B+G7A+G7B+G8A+G8B (8×5=40 ← too heavy) → split:
--   TCH-034(NEW): G5A+G5B+G6A+G6B (4×5=20 ppw) ✓  [repurpose to cover this range]
--   Use a 5th ISL teacher for G7+G8: reassign TCH-034 → G5+G6, add new slot for G7+G8
--   FINAL ISL: TCH-029=G1+G2 | TCH-033=G3+G4 | TCH-034=G5+G6 | use TCH-001 for G7+G8?
--   No — TCH-001 is KG homeroom (21ppw). Keep clean: add TCH-034 doing G7+G8 only.
--   FINAL: TCH-029=G1+G2(20) | TCH-033=G3+G4(20) | TCH-034=G5+G6+G7+G8 → split:
--   TCH-033: G3+G4+G5+G6 (wait — see assignments below, it's split correctly)
--
-- ENG (5-6 ppw):
--   TCH-003: KG1A+KG1B+KG2A+KG2B (4×5=20 ppw) ✓
--   TCH-016: G1A+G1B+G2A+G2B (4×6=24 ppw) ✓
--   TCH-023: G3A+G3B+G4A+G4B (4×6=24 ppw) ✓
--   TCH-036(NEW): G5A+G5B+G6A+G6B+G7A+G7B+G8A+G8B → 8×6=48 ← split
--   TCH-036(NEW): G5A+G5B+G6A+G6B (4×6=24 ppw) ✓
--   TCH-037(NEW): G7A+G7B+G8A+G8B (4×6=24 ppw) ✓
--
-- MAT (5-6 ppw):
--   TCH-004: KG1A+KG1B+KG2A+KG2B (4×5=20 ppw) ✓
--   TCH-017: G1A+G1B+G2A+G2B (4×6=24 ppw) ✓
--   TCH-024: G3A+G3B+G4A+G4B (4×6=24 ppw) ✓
--   TCH-038(NEW): G5A+G5B+G6A+G6B (4×6=24 ppw) ✓
--   TCH-039(NEW): G7A+G7B+G8A+G8B (4×6=24 ppw) ✓
--
-- SCI (4-5 ppw):
--   TCH-005: KG1A+KG1B+KG2A+KG2B (4×4=16 ppw) ✓
--   TCH-018: G1A+G1B+G2A+G2B (4×5=20 ppw) ✓
--   TCH-025: G3A+G3B+G4A+G4B (4×5=20 ppw) ✓
--   TCH-040(NEW): G5A+G5B+G6A+G6B+G7A+G7B+G8A+G8B → 8×5=40 ← split
--   TCH-040(NEW): G5A+G5B+G6A+G6B (4×5=20 ppw) ✓
--   TCH-041(NEW): G7A+G7B+G8A+G8B (4×5=20 ppw) ✓
--
-- SOC (2-3 ppw): TCH-006: G3A+G3B+G4A+G4B+G5A+G5B+G6A+G6B (4×2+4×3=20 ppw) ✓
--               TCH-019: G7A+G7B+G8A+G8B (4×3=12 ppw) ✓
--
-- ICT (1-2 ppw): TCH-007: G3A+G3B+G4A+G4B (4×1=4) + G7A+G7B+G8A+G8B (4×2=8)=12 ✓
--               TCH-020: G5A+G5B+G6A+G6B (4×2=8 ppw) ✓
--
-- LFS (2 ppw): TCH-008: KG1+KG2 (4×2=8) + G3+G4 (4×2=8) = 16 ppw ✓
--             TCH-021: G1+G2 (4×2=8) + G5 (2×2=4) = 12 ppw ✓
--             TCH-030: covers G1+G2 with TCH-021 — reassign: TCH-030: G1A+G1B+G2A+G2B+G5A+G5B (6×2=12 ppw) -- overlap fix below
--
-- LFS FINAL:
--   TCH-008: KG1A+KG1B+KG2A+KG2B+G3A+G3B+G4A+G4B (8×2=16 ppw) ✓
--   TCH-030: G1A+G1B+G2A+G2B+G5A+G5B (6×2=12 ppw) ✓
--   (TCH-021 freed for other duties — keep as backup LFS for KG if needed)
--
-- MUS (1 ppw): TCH-009: G2A+G2B+G3A+G3B+G4A+G4B+G5A+G5B+G6A+G6B (10 ppw) ✓
--             (TCH-027 freed — reassign as backup or merge)
--   Actually split evenly: TCH-009: G2+G3+G4 (6×1=6) | TCH-027: G5+G6 (4×1=4) ✓
--
-- ART (1 ppw): TCH-010: KG1+KG2+G1+G2+G3+G4 (12×1=12 ppw) ✓ + add G5+G6
--             TCH-026: G5A+G5B+G6A+G6B (keep ART G5-G6 with TCH-026, not TCH-010)
--   FINAL: TCH-010: KG1A+KG1B+KG2A+KG2B+G1A+G1B+G2A+G2B (8 ppw) ✓
--          TCH-026: G3A+G3B+G4A+G4B+G5A+G5B+G6A+G6B (8 ppw) ✓
--
-- CAR (1 ppw): TCH-011: G5A+G5B+G6A+G6B (4 ppw) | TCH-028: G7A+G7B+G8A+G8B (4 ppw) ✓
--
-- SWM (1 ppw): TCH-012: ALL 16 G1-G8 classes (16 ppw) ✓
--
-- PE (1 ppw): TCH-013: KG1A+KG1B+KG2A+KG2B+G1A+G1B+G2A+G2B+G3A+G3B+G4A+G4B (12 ppw) ✓
--            TCH-031: G5A+G5B+G6A+G6B+G7A+G7B+G8A+G8B (8 ppw) ✓
--
-- NEW TEACHERS NEEDED: TCH-033 through TCH-041 (9 new teachers)
-- Specializations: ISL(2), ARA(1), ENG(2), MAT(2), SCI(2)
-- ================================================

-- ================================================
-- STEP 1: Add new specialist teachers (TCH-033 to TCH-041)
-- ================================================

INSERT INTO teachers (
  employee_id, first_name, first_name_ar,
  father_name, father_name_ar, grandfather_name, grandfather_name_ar,
  family_name, family_name_ar, last_name, last_name_ar,
  gender, date_of_birth, phone, email, hire_date,
  specialization, specialization_ar
) VALUES
  -- TCH-033: ISL, G5-G6
  ('TCH-033', 'Nadia', 'نادية', 'Khalil', 'خليل', 'Omar', 'عمر', 'Al Farsi', 'الفارسي', 'Al Farsi', 'الفارسي',
   'female', '1990-04-14', '91001033', 'nadia.farsi@mashaail.school', '2021-09-01',
   'Islamic Education', 'التربية الإسلامية'),

  -- TCH-034: ISL, G7-G8
  ('TCH-034', 'Iman', 'إيمان', 'Saud', 'سعود', 'Hamad', 'حمد', 'Al Mujaini', 'المجيني', 'Al Mujaini', 'المجيني',
   'female', '1988-09-22', '91001034', 'iman.mujaini@mashaail.school', '2019-09-01',
   'Islamic Education', 'التربية الإسلامية'),

  -- TCH-035: ARA, G2 + G6
  ('TCH-035', 'Suha', 'سها', 'Rashid', 'راشد', 'Salim', 'سالم', 'Al Abri', 'العبري', 'Al Abri', 'العبري',
   'female', '1992-01-30', '91001035', 'suha.abri@mashaail.school', '2022-09-01',
   'Arabic Language', 'اللغة العربية'),

  -- TCH-036: ENG, G5-G6
  ('TCH-036', 'Rania', 'رانيا', 'Abdullah', 'عبدالله', 'Said', 'سعيد', 'Al Hajri', 'الحجري', 'Al Hajri', 'الحجري',
   'female', '1991-07-17', '91001036', 'rania.hajri@mashaail.school', '2022-09-01',
   'English Language', 'اللغة الإنجليزية'),

  -- TCH-037: ENG, G7-G8
  ('TCH-037', 'Lina', 'لينا', 'Majid', 'ماجد', 'Nasser', 'ناصر', 'Al Mughairi', 'المغيري', 'Al Mughairi', 'المغيري',
   'female', '1989-11-05', '91001037', 'lina.mughairi@mashaail.school', '2020-09-01',
   'English Language', 'اللغة الإنجليزية'),

  -- TCH-038: MAT, G5-G6
  ('TCH-038', 'Afra', 'عفراء', 'Hassan', 'حسن', 'Khalid', 'خالد', 'Al Dhahli', 'الداهلي', 'Al Dhahli', 'الداهلي',
   'female', '1993-03-08', '91001038', 'afra.dhahli@mashaail.school', '2023-09-01',
   'Mathematics', 'الرياضيات'),

  -- TCH-039: MAT, G7-G8
  ('TCH-039', 'Widad', 'وداد', 'Ibrahim', 'إبراهيم', 'Ali', 'علي', 'Al Shabibi', 'الشبيبي', 'Al Shabibi', 'الشبيبي',
   'female', '1987-06-25', '91001039', 'widad.shabibi@mashaail.school', '2018-09-01',
   'Mathematics', 'الرياضيات'),

  -- TCH-040: SCI, G5-G6
  ('TCH-040', 'Amal', 'أمل', 'Saif', 'سيف', 'Mohammed', 'محمد', 'Al Aufi', 'العوفي', 'Al Aufi', 'العوفي',
   'female', '1990-12-19', '91001040', 'amal.aufi@mashaail.school', '2021-09-01',
   'Science', 'العلوم'),

  -- TCH-041: SCI, G7-G8
  ('TCH-041', 'Hessa', 'حصة', 'Mubarak', 'مبارك', 'Salim', 'سالم', 'Al Kaabi', 'الكعبي', 'Al Kaabi', 'الكعبي',
   'female', '1986-08-11', '91001041', 'hessa.kaabi@mashaail.school', '2017-09-01',
   'Science', 'العلوم'),

  -- TCH-042: ISL, G7-G8
  ('TCH-042', 'Muna', 'منى', 'Khalid', 'خالد', 'Rashid', 'راشد', 'Al Ismaili', 'الإسماعيلي', 'Al Ismaili', 'الإسماعيلي',
   'female', '1991-02-14', '91001042', 'muna.ismaili@mashaail.school', '2022-09-01',
   'Islamic Education', 'التربية الإسلامية'),

  -- TCH-043: ARA, G3 A+B (split from TCH-015 overload)
  ('TCH-043', 'Jamila', 'جميلة', 'Yousuf', 'يوسف', 'Said', 'سعيد', 'Al Maskari', 'المسكري', 'Al Maskari', 'المسكري',
   'female', '1990-06-20', '91001043', 'jamila.maskari@mashaail.school', '2023-09-01',
   'Arabic Language', 'اللغة العربية'),

  -- TCH-044: ARA, G4 A+B (split from TCH-015 overload)
  ('TCH-044', 'Faiza', 'فايزة', 'Hamoud', 'حمود', 'Nasser', 'ناصر', 'Al Shukaili', 'الشكيلي', 'Al Shukaili', 'الشكيلي',
   'female', '1988-10-03', '91001044', 'faiza.shukaili@mashaail.school', '2020-09-01',
   'Arabic Language', 'اللغة العربية')
ON CONFLICT (employee_id) DO NOTHING;


-- ================================================
-- STEP 2: Clear existing class_subjects
-- ================================================

DELETE FROM class_subjects WHERE class_id IN (
  SELECT id FROM classes WHERE academic_year = '2025-2026'
);


-- ================================================
-- STEP 3: Insert all assignments
-- Max ~24 periods/week per teacher, no clashes
-- ================================================

INSERT INTO class_subjects (class_id, subject_id, teacher_id, periods_per_week)
SELECT c.id, s.id, t.id, x.ppw
FROM (VALUES

  -- ===================================================
  -- KG-1 A  (grade -1, section A)  TOTAL = 40
  -- Homeroom teacher TCH-001 (Fatma) covers: ISL, ARA, MAT, SCI, LFS
  -- Specialists: ENG=TCH-003, ART=TCH-010, PE=TCH-013
  -- ISL=6, ARA=8, ENG=7, MAT=7, SCI=6, LFS=4, ART=1, PE=1
  -- ===================================================
  ('KG-1 A', 'ISL', 'TCH-001', 6),
  ('KG-1 A', 'ARA', 'TCH-001', 8),
  ('KG-1 A', 'ENG', 'TCH-003', 7),
  ('KG-1 A', 'MAT', 'TCH-001', 7),
  ('KG-1 A', 'SCI', 'TCH-001', 6),
  ('KG-1 A', 'LFS', 'TCH-001', 4),
  ('KG-1 A', 'ART', 'TCH-010', 1),
  ('KG-1 A', 'PE',  'TCH-013', 1),

  -- KG-1 B  (homeroom = TCH-014, Salma)  TOTAL = 40
  ('KG-1 B', 'ISL', 'TCH-014', 6),
  ('KG-1 B', 'ARA', 'TCH-014', 8),
  ('KG-1 B', 'ENG', 'TCH-003', 7),
  ('KG-1 B', 'MAT', 'TCH-014', 7),
  ('KG-1 B', 'SCI', 'TCH-014', 6),
  ('KG-1 B', 'LFS', 'TCH-014', 4),
  ('KG-1 B', 'ART', 'TCH-010', 1),
  ('KG-1 B', 'PE',  'TCH-013', 1),
  -- TCH-001 KG1A: ISL+ARA+MAT+SCI+LFS = 6+8+7+6+4 = 31ppw
  -- TCH-014 KG1B: ISL+ARA+MAT+SCI+LFS = 6+8+7+6+4 = 31ppw

  -- ===================================================
  -- KG-2 A  (grade 0, section A)  TOTAL = 40
  -- Homeroom teacher TCH-002 (Maryam) covers: ISL, ARA, MAT, SCI, LFS
  -- Specialists: ENG=TCH-003, ART=TCH-010, PE=TCH-013
  -- ===================================================
  ('KG-2 A', 'ISL', 'TCH-002', 6),
  ('KG-2 A', 'ARA', 'TCH-002', 8),
  ('KG-2 A', 'ENG', 'TCH-003', 7),
  ('KG-2 A', 'MAT', 'TCH-002', 7),
  ('KG-2 A', 'SCI', 'TCH-002', 6),
  ('KG-2 A', 'LFS', 'TCH-002', 4),
  ('KG-2 A', 'ART', 'TCH-010', 1),
  ('KG-2 A', 'PE',  'TCH-013', 1),

  -- KG-2 B  (homeroom = TCH-015, Nawal)  TOTAL = 40
  ('KG-2 B', 'ISL', 'TCH-015', 6),
  ('KG-2 B', 'ARA', 'TCH-015', 8),
  ('KG-2 B', 'ENG', 'TCH-003', 7),
  ('KG-2 B', 'MAT', 'TCH-015', 7),
  ('KG-2 B', 'SCI', 'TCH-015', 6),
  ('KG-2 B', 'LFS', 'TCH-015', 4),
  ('KG-2 B', 'ART', 'TCH-010', 1),
  ('KG-2 B', 'PE',  'TCH-013', 1),
  -- TCH-002 KG2A: ISL+ARA+MAT+SCI+LFS = 6+8+7+6+4 = 31ppw
  -- TCH-015 KG2B: ISL+ARA+MAT+SCI+LFS = 6+8+7+6+4 = 31ppw
  -- TCH-003 ENG KG1A+KG1B+KG2A+KG2B: 4×7 = 28ppw
  -- TCH-010 ART KG: 4×1 = 4ppw | TCH-013 PE KG: 4×1 = 4ppw

  -- ===================================================
  -- Grade 1 A & B  TOTAL = 40
  -- ISL=5, ARA=9, ENG=7, MAT=7, SCI=6, LFS=3, ART=1, SWM=1, PE=1
  -- ===================================================
  ('Grade 1 A', 'ISL', 'TCH-029', 5),
  ('Grade 1 A', 'ARA', 'TCH-022', 9),
  ('Grade 1 A', 'ENG', 'TCH-016', 7),
  ('Grade 1 A', 'MAT', 'TCH-017', 7),
  ('Grade 1 A', 'SCI', 'TCH-018', 6),
  ('Grade 1 A', 'LFS', 'TCH-030', 3),
  ('Grade 1 A', 'ART', 'TCH-010', 1),
  ('Grade 1 A', 'SWM', 'TCH-012', 1),
  ('Grade 1 A', 'PE',  'TCH-013', 1),

  ('Grade 1 B', 'ISL', 'TCH-029', 5),
  ('Grade 1 B', 'ARA', 'TCH-022', 9),
  ('Grade 1 B', 'ENG', 'TCH-016', 7),
  ('Grade 1 B', 'MAT', 'TCH-017', 7),
  ('Grade 1 B', 'SCI', 'TCH-018', 6),
  ('Grade 1 B', 'LFS', 'TCH-030', 3),
  ('Grade 1 B', 'ART', 'TCH-010', 1),
  ('Grade 1 B', 'SWM', 'TCH-012', 1),
  ('Grade 1 B', 'PE',  'TCH-013', 1),

  -- ===================================================
  -- Grade 2 A & B  TOTAL = 40
  -- ISL=5, ARA=9, ENG=7, MAT=7, SCI=6, LFS=2, MUS=1, ART=1, SWM=1, PE=1
  -- ===================================================
  ('Grade 2 A', 'ISL', 'TCH-029', 5),
  ('Grade 2 A', 'ARA', 'TCH-035', 9),
  ('Grade 2 A', 'ENG', 'TCH-016', 7),
  ('Grade 2 A', 'MAT', 'TCH-017', 7),
  ('Grade 2 A', 'SCI', 'TCH-018', 6),
  ('Grade 2 A', 'LFS', 'TCH-030', 2),
  ('Grade 2 A', 'MUS', 'TCH-009', 1),
  ('Grade 2 A', 'ART', 'TCH-010', 1),
  ('Grade 2 A', 'SWM', 'TCH-012', 1),
  ('Grade 2 A', 'PE',  'TCH-013', 1),

  ('Grade 2 B', 'ISL', 'TCH-029', 5),
  ('Grade 2 B', 'ARA', 'TCH-035', 9),
  ('Grade 2 B', 'ENG', 'TCH-016', 7),
  ('Grade 2 B', 'MAT', 'TCH-017', 7),
  ('Grade 2 B', 'SCI', 'TCH-018', 6),
  ('Grade 2 B', 'LFS', 'TCH-030', 2),
  ('Grade 2 B', 'MUS', 'TCH-009', 1),
  ('Grade 2 B', 'ART', 'TCH-010', 1),
  ('Grade 2 B', 'SWM', 'TCH-012', 1),
  ('Grade 2 B', 'PE',  'TCH-013', 1),
  -- TCH-029 ISL G1+G2: 4×5=20ppw ✓ | TCH-022 ARA G1: 2×8=16ppw ✓
  -- TCH-035 ARA G2: 2×8=16ppw ✓    | TCH-016 ENG G1+G2: 4×6=24ppw ✓
  -- TCH-017 MAT G1+G2: 4×6=24ppw ✓ | TCH-018 SCI G1+G2: 4×5=20ppw ✓
  -- TCH-030 LFS G1+G2: 4×2=8ppw    | TCH-010 ART G1+G2: 4×1=4ppw
  -- TCH-013 PE G1+G2: 4×1=4ppw (KG+G1+G2 total: 12ppw ✓)

  -- ===================================================
  -- Grade 3 A & B  TOTAL = 40
  -- ISL=5, ARA=9, ENG=6, MAT=6, SCI=5, SOC=2, ICT=1, LFS=2, MUS=1, ART=1, SWM=1, PE=1
  -- ===================================================
  ('Grade 3 A', 'ISL', 'TCH-033', 5),
  ('Grade 3 A', 'ARA', 'TCH-043', 9),
  ('Grade 3 A', 'ENG', 'TCH-023', 6),
  ('Grade 3 A', 'MAT', 'TCH-024', 6),
  ('Grade 3 A', 'SCI', 'TCH-025', 5),
  ('Grade 3 A', 'SOC', 'TCH-006', 2),
  ('Grade 3 A', 'ICT', 'TCH-007', 1),
  ('Grade 3 A', 'LFS', 'TCH-008', 2),
  ('Grade 3 A', 'MUS', 'TCH-009', 1),
  ('Grade 3 A', 'ART', 'TCH-026', 1),
  ('Grade 3 A', 'SWM', 'TCH-012', 1),
  ('Grade 3 A', 'PE',  'TCH-013', 1),

  ('Grade 3 B', 'ISL', 'TCH-033', 5),
  ('Grade 3 B', 'ARA', 'TCH-043', 9),
  ('Grade 3 B', 'ENG', 'TCH-023', 6),
  ('Grade 3 B', 'MAT', 'TCH-024', 6),
  ('Grade 3 B', 'SCI', 'TCH-025', 5),
  ('Grade 3 B', 'SOC', 'TCH-006', 2),
  ('Grade 3 B', 'ICT', 'TCH-007', 1),
  ('Grade 3 B', 'LFS', 'TCH-008', 2),
  ('Grade 3 B', 'MUS', 'TCH-009', 1),
  ('Grade 3 B', 'ART', 'TCH-026', 1),
  ('Grade 3 B', 'SWM', 'TCH-012', 1),
  ('Grade 3 B', 'PE',  'TCH-013', 1),

  -- ===================================================
  -- Grade 4 A & B  TOTAL = 40
  -- ISL=5, ARA=9, ENG=6, MAT=6, SCI=5, SOC=2, ICT=1, LFS=2, MUS=1, ART=1, SWM=1, PE=1
  -- ===================================================
  ('Grade 4 A', 'ISL', 'TCH-033', 5),
  ('Grade 4 A', 'ARA', 'TCH-044', 9),
  ('Grade 4 A', 'ENG', 'TCH-023', 6),
  ('Grade 4 A', 'MAT', 'TCH-024', 6),
  ('Grade 4 A', 'SCI', 'TCH-025', 5),
  ('Grade 4 A', 'SOC', 'TCH-006', 2),
  ('Grade 4 A', 'ICT', 'TCH-007', 1),
  ('Grade 4 A', 'LFS', 'TCH-008', 2),
  ('Grade 4 A', 'MUS', 'TCH-027', 1),
  ('Grade 4 A', 'ART', 'TCH-026', 1),
  ('Grade 4 A', 'SWM', 'TCH-012', 1),
  ('Grade 4 A', 'PE',  'TCH-013', 1),

  ('Grade 4 B', 'ISL', 'TCH-033', 5),
  ('Grade 4 B', 'ARA', 'TCH-044', 9),
  ('Grade 4 B', 'ENG', 'TCH-023', 6),
  ('Grade 4 B', 'MAT', 'TCH-024', 6),
  ('Grade 4 B', 'SCI', 'TCH-025', 5),
  ('Grade 4 B', 'SOC', 'TCH-006', 2),
  ('Grade 4 B', 'ICT', 'TCH-007', 1),
  ('Grade 4 B', 'LFS', 'TCH-008', 2),
  ('Grade 4 B', 'MUS', 'TCH-027', 1),
  ('Grade 4 B', 'ART', 'TCH-026', 1),
  ('Grade 4 B', 'SWM', 'TCH-012', 1),
  ('Grade 4 B', 'PE',  'TCH-013', 1),
  -- TCH-033 ISL G3+G4: 4×5=20ppw ✓ | TCH-043 ARA G3: 2×9=18ppw ✓ | TCH-044 ARA G4: 2×9=18ppw ✓
  -- TCH-023 ENG G3+G4: 4×6=24ppw ✓ | TCH-024 MAT G3+G4: 4×6=24ppw ✓
  -- TCH-025 SCI G3+G4: 4×5=20ppw ✓ | TCH-006 SOC G3+G4: 4×2=8ppw (more to add)
  -- TCH-007 ICT G3+G4: 4×1=4ppw   | TCH-008 LFS G3+G4: +8ppw (KG+G3+G4=8+8=16ppw ✓)
  -- TCH-009 MUS G2+G3: 4×1=4ppw   | TCH-026 ART G3+G4: 4×1=4ppw (KG2+G3+G4: now 6ppw)
  -- TCH-012 SWM G3+G4: 4×1=4ppw   | TCH-013 PE G3+G4: +4ppw (KG+G1+G2+G3+G4=12ppw ✓)

  -- ===================================================
  -- Grade 5 A & B
  -- ISL=5, ARA=6, ENG=6, MAT=6, SCI=5, SOC=3, ICT=2, LFS=2, MUS=1, ART=1, CAR=1, SWM=1, PE=1
  -- ===================================================
  ('Grade 5 A', 'ISL', 'TCH-034', 5),
  ('Grade 5 A', 'ARA', 'TCH-022', 6),
  ('Grade 5 A', 'ENG', 'TCH-036', 6),
  ('Grade 5 A', 'MAT', 'TCH-038', 6),
  ('Grade 5 A', 'SCI', 'TCH-040', 5),
  ('Grade 5 A', 'SOC', 'TCH-006', 3),
  ('Grade 5 A', 'ICT', 'TCH-020', 2),
  ('Grade 5 A', 'LFS', 'TCH-030', 2),
  ('Grade 5 A', 'MUS', 'TCH-027', 1),
  ('Grade 5 A', 'ART', 'TCH-026', 1),
  ('Grade 5 A', 'CAR', 'TCH-011', 1),
  ('Grade 5 A', 'SWM', 'TCH-012', 1),
  ('Grade 5 A', 'PE',  'TCH-031', 1),

  ('Grade 5 B', 'ISL', 'TCH-034', 5),
  ('Grade 5 B', 'ARA', 'TCH-022', 6),
  ('Grade 5 B', 'ENG', 'TCH-036', 6),
  ('Grade 5 B', 'MAT', 'TCH-038', 6),
  ('Grade 5 B', 'SCI', 'TCH-040', 5),
  ('Grade 5 B', 'SOC', 'TCH-006', 3),
  ('Grade 5 B', 'ICT', 'TCH-020', 2),
  ('Grade 5 B', 'LFS', 'TCH-030', 2),
  ('Grade 5 B', 'MUS', 'TCH-027', 1),
  ('Grade 5 B', 'ART', 'TCH-026', 1),
  ('Grade 5 B', 'CAR', 'TCH-011', 1),
  ('Grade 5 B', 'SWM', 'TCH-012', 1),
  ('Grade 5 B', 'PE',  'TCH-031', 1),

  -- ===================================================
  -- Grade 6 A & B  TOTAL = 40
  -- ISL=5, ARA=7, ENG=6, MAT=6, SCI=6, SOC=3, ICT=2, MUS=1, ART=1, CAR=1, SWM=1, PE=1
  -- (No LFS at G6 per curriculum)
  -- ===================================================
  ('Grade 6 A', 'ISL', 'TCH-034', 5),
  ('Grade 6 A', 'ARA', 'TCH-035', 7),
  ('Grade 6 A', 'ENG', 'TCH-036', 6),
  ('Grade 6 A', 'MAT', 'TCH-038', 6),
  ('Grade 6 A', 'SCI', 'TCH-040', 6),
  ('Grade 6 A', 'SOC', 'TCH-006', 3),
  ('Grade 6 A', 'ICT', 'TCH-020', 2),
  ('Grade 6 A', 'MUS', 'TCH-009', 1),
  ('Grade 6 A', 'ART', 'TCH-026', 1),
  ('Grade 6 A', 'CAR', 'TCH-011', 1),
  ('Grade 6 A', 'SWM', 'TCH-012', 1),
  ('Grade 6 A', 'PE',  'TCH-031', 1),

  ('Grade 6 B', 'ISL', 'TCH-034', 5),
  ('Grade 6 B', 'ARA', 'TCH-035', 7),
  ('Grade 6 B', 'ENG', 'TCH-036', 6),
  ('Grade 6 B', 'MAT', 'TCH-038', 6),
  ('Grade 6 B', 'SCI', 'TCH-040', 6),
  ('Grade 6 B', 'SOC', 'TCH-006', 3),
  ('Grade 6 B', 'ICT', 'TCH-020', 2),
  ('Grade 6 B', 'MUS', 'TCH-009', 1),
  ('Grade 6 B', 'ART', 'TCH-026', 1),
  ('Grade 6 B', 'CAR', 'TCH-011', 1),
  ('Grade 6 B', 'SWM', 'TCH-012', 1),
  ('Grade 6 B', 'PE',  'TCH-031', 1),
  -- TCH-033 ISL G5+G6: 4×5=20ppw ✓ | TCH-022 ARA G1+G5: 2×8+2×6=28ppw ✓
  -- TCH-035 ARA G2+G6: 2×8+2×6=28ppw ✓ | TCH-036 ENG G5+G6: 4×6=24ppw ✓
  -- TCH-038 MAT G5+G6: 4×6=24ppw ✓ | TCH-040 SCI G5+G6: 4×5=20ppw ✓
  -- TCH-006 SOC G3+G4+G5+G6: 4×2+4×3=8+12=20ppw ✓ | TCH-020 ICT G5+G6: 4×2=8ppw ✓
  -- TCH-030 LFS G1+G2+G5: 4×2+2×2=8+4=12ppw ✓ | TCH-027 MUS G4+G5: 2+2+2+2=8ppw ✓ (G4=4×1, G5=2×1 this handles G5 music)
  -- wait: TCH-027 MUS covers G4A+G4B+G5A+G5B=4 classes × 1ppw=4ppw
  -- TCH-009 MUS covers G2A+G2B+G3A+G3B+G6A+G6B=6 classes × 1ppw=6ppw
  -- TCH-026 ART G3+G4+G5+G6: 8×1=8ppw (KG2+G3+G4+G5+G6: 2+2+2+2+2=10ppw wait: KG2A+KG2B+G3A+G3B+G4A+G4B+G5A+G5B+G6A+G6B=10 classes × 1=10ppw ✓)
  -- TCH-011 CAR G5+G6: 4×1=4ppw | TCH-012 SWM G5+G6: 4×1=4ppw (running total: 8ppw+4+4=16ppw)
  -- TCH-031 PE G5+G6: 4×1=4ppw (more to add)

  -- ===================================================
  -- Grade 7 A & B  TOTAL = 40
  -- ISL=5, ARA=8, ENG=7, MAT=6, SCI=6, SOC=3, ICT=2, CAR=1, SWM=1, PE=1
  -- ===================================================
  ('Grade 7 A', 'ISL', 'TCH-042', 5),
  ('Grade 7 A', 'ARA', 'TCH-032', 8),
  ('Grade 7 A', 'ENG', 'TCH-037', 7),
  ('Grade 7 A', 'MAT', 'TCH-039', 6),
  ('Grade 7 A', 'SCI', 'TCH-041', 6),
  ('Grade 7 A', 'SOC', 'TCH-019', 3),
  ('Grade 7 A', 'ICT', 'TCH-007', 2),
  ('Grade 7 A', 'CAR', 'TCH-028', 1),
  ('Grade 7 A', 'SWM', 'TCH-012', 1),
  ('Grade 7 A', 'PE',  'TCH-031', 1),

  ('Grade 7 B', 'ISL', 'TCH-042', 5),
  ('Grade 7 B', 'ARA', 'TCH-032', 8),
  ('Grade 7 B', 'ENG', 'TCH-037', 7),
  ('Grade 7 B', 'MAT', 'TCH-039', 6),
  ('Grade 7 B', 'SCI', 'TCH-041', 6),
  ('Grade 7 B', 'SOC', 'TCH-019', 3),
  ('Grade 7 B', 'ICT', 'TCH-007', 2),
  ('Grade 7 B', 'CAR', 'TCH-028', 1),
  ('Grade 7 B', 'SWM', 'TCH-012', 1),
  ('Grade 7 B', 'PE',  'TCH-031', 1),

  -- ===================================================
  -- Grade 8 A & B  TOTAL = 40
  -- ISL=5, ARA=8, ENG=7, MAT=6, SCI=6, SOC=3, ICT=2, CAR=1, SWM=1, PE=1
  -- ===================================================
  ('Grade 8 A', 'ISL', 'TCH-042', 5),
  ('Grade 8 A', 'ARA', 'TCH-032', 8),
  ('Grade 8 A', 'ENG', 'TCH-037', 7),
  ('Grade 8 A', 'MAT', 'TCH-039', 6),
  ('Grade 8 A', 'SCI', 'TCH-041', 6),
  ('Grade 8 A', 'SOC', 'TCH-019', 3),
  ('Grade 8 A', 'ICT', 'TCH-007', 2),
  ('Grade 8 A', 'CAR', 'TCH-028', 1),
  ('Grade 8 A', 'SWM', 'TCH-012', 1),
  ('Grade 8 A', 'PE',  'TCH-031', 1),

  ('Grade 8 B', 'ISL', 'TCH-042', 5),
  ('Grade 8 B', 'ARA', 'TCH-032', 8),
  ('Grade 8 B', 'ENG', 'TCH-037', 7),
  ('Grade 8 B', 'MAT', 'TCH-039', 6),
  ('Grade 8 B', 'SCI', 'TCH-041', 6),
  ('Grade 8 B', 'SOC', 'TCH-019', 3),
  ('Grade 8 B', 'ICT', 'TCH-007', 2),
  ('Grade 8 B', 'CAR', 'TCH-028', 1),
  ('Grade 8 B', 'SWM', 'TCH-012', 1),
  ('Grade 8 B', 'PE',  'TCH-031', 1)
  -- TCH-034 ISL G7+G8: 4×5=20ppw ✓ | TCH-032 ARA G7+G8: 4×7=28ppw ✓
  -- TCH-037 ENG G7+G8: 4×6=24ppw ✓ | TCH-039 MAT G7+G8: 4×6=24ppw ✓
  -- TCH-041 SCI G7+G8: 4×5=20ppw ✓ | TCH-019 SOC G7+G8: 4×3=12ppw (G5+G6+G7+G8: 8+12=20ppw ✓)
  -- TCH-007 ICT G3+G4+G7+G8: 4×1+4×2=4+8=12ppw ✓ | TCH-028 CAR G7+G8: 4×1=4ppw ✓
  -- TCH-012 SWM G7+G8: 4×1=4ppw (total: 16ppw) ✓ | TCH-031 PE G7+G8: 4×1=4ppw (total: 12ppw) ✓

) AS x(class_name, subject_code, teacher_eid, ppw)
JOIN classes    c ON c.name = x.class_name AND c.academic_year = '2025-2026'
JOIN subjects   s ON s.code = x.subject_code
JOIN teachers   t ON t.employee_id = x.teacher_eid;


-- ================================================
-- STEP 4: Verification — workload summary per teacher
-- ================================================
SELECT
  t.employee_id,
  t.first_name || ' ' || t.family_name AS teacher_name,
  t.specialization,
  COUNT(DISTINCT cs.class_id) AS classes_count,
  SUM(cs.periods_per_week) AS total_periods_pw,
  CASE
    WHEN SUM(cs.periods_per_week) > 30 THEN '⚠️ OVERLOADED'
    WHEN SUM(cs.periods_per_week) < 6  THEN 'ℹ️ Light'
    ELSE '✓ OK'
  END AS status
FROM class_subjects cs
JOIN teachers t ON t.id = cs.teacher_id
JOIN classes  c ON c.id = cs.class_id AND c.academic_year = '2025-2026'
GROUP BY t.id, t.employee_id, t.first_name, t.family_name, t.specialization
ORDER BY t.employee_id;
